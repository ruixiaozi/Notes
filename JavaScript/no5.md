## JavaScript学习笔记 生命周期与垃圾回收
---
### 1. 生命周期

+ 全局环境中的变量  
    &emsp;&emsp;其生命周期从程序开始一直到程序关闭为止。
+ 局部环境中的变量  
    &emsp;&emsp;其生命周期一般来说是从函数执行开始到函数执行结束为止，于是当函数执行结束的时候，释放局部变量理所当然。**但是并非所有情况都是这样的**，比如引用对象的变量，是否应该释放它引用对象的空间，因为它可能还被另一个执行环境的变量所引用，它的生命周期就**不仅仅限于该函数内部**，这就需要一些机制来处理他们的生命周期。

---
### 2. 垃圾回收机制(JavaScript)

1. 标记清除（主流）  
    &emsp;&emsp;垃圾回收器在运行的时候会被存储在内存中的所有变量加上标记，然后去掉环境中的变量、被环境中变量引用的变量的标记。最后，垃圾回收器就会执行清理工作，销毁那些带着标记的值并回收它们的空间。
2. 引用计数（存在问题）  
    &emsp;&emsp;当声明一个变量并将一个引用类型值赋值给该变量时，这个值的引用次数就+1，如果该引用类型值又被赋值给另一个变量，则再+1。相反，如果引用该值的变量取得了一个其他值，则该值的引用次数-1。当这个值的引用次数变成0的时候，就释放空间并回收。  
    &emsp;&emsp;但是存在一个问题：`循环引用` ，对象A包含一个指向对象B的引用，对象B也包含一个指向对象A的引用，这样就算A和B都没有变量引用，但被互相引用，就会导致内存得不到释放。**为了避免这种问题，应该在不使用对象的时候，手动 `解除引用`（既给变量赋值null）**



---

#### [返回目录](./)