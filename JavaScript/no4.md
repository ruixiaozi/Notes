## JavaScript学习笔记 函数与作用域
---
### 1. 函数

&emsp;&emsp;ECMAScript中函数的格式如下：
```
function fName(arg0, arg1, ..., argN){
    语句
}
```
&emsp;&emsp;同时在ECMAScript中，函数还具有以下几个特点：
1. 在定义时**不必指定是否返回值**。可以使用 `return` 语句后跟要返回的值来实现返回值。同样 `return` 语句可以不带值，默认返回 `undefined` 。
2. 传递参数的时候，可以**传递任意个数和类型的参数**，不需要与函数定义时个数一样。实际上，在函数体内部可以通过 `arguments` 变量来访问这个实际传入的参数数组。定义时的命名参数只是提供便利，但不是必须的。没有被传递值的参数，被自动赋予 `undefined`。
3. 参数是**按值传递**的，但是由于 `引用类型` 是保存的 `引用` 值，所以传递的也是一个引用。
4. **没有重载，但是后续的定义会覆盖前面的函数定义**。在ECMAScript中，函数其实也是一种引用数据类型，函数名就相当于变量名，引用了一个函数的定义，所以后续定义的函数会覆盖掉前面的函数定义。但是可以利用参数特性，实现传入不同参数个数和类型的不同处理方式，模仿重载。

---
### 2. 执行环境

&emsp;&emsp;执行环境只指：代码所执行的区域。每个执行环境都有一个与之相关的**变量对象**，环境中定义的变量和函数都保存在这个对象中。执行环境一共分为两种：
1. 全局执行环境：最外围的一个执行环境，全局的变量和函数都是保存在全局执行环境中，在web浏览器中，全局执行环境就是 `windows` 对象。
2. 局部执行环境：每个函数的执行环境，函数的参数、内部变量等都是保存在局部执行环境中。


---
### 3. 作用域

1. 作用域链：  
    &emsp;&emsp;当代码在一个执行环节中执行的时候，会先创建一个 `作用域链` ，作用域链开头是当前执行环节的 `变量对象`，链表的下一个则是包含当前执行环境的 `变量对象` ……依次类推，最后一个 `变量对象` 就是全局执行环节的 `变量对象` 。  
2. 查询：  
    &emsp;&emsp;在代码执行过程中，查找某一个变量或函数时，就从 `作用域链` 的开头依次往下找，找到第一个为止。
3. 作用域：  
    &emsp;&emsp;所以这样就有了 `作用域` ：内部环境可以访问外部环境，而外部环境不可能以访问内部的任何变量和函数。
4. 定义变量的作用域：  
    &emsp;&emsp;`var` 声明变量会添加到**当前所处的执行环境**中，也就说明了没有块级作用域的原理。而不使用 `var` 声明变量，就会依次查找，直到全局执行环境还未定义，那么就会**自动在全局执行环境中添加**。
5. 特殊作用域：  
    &emsp;&emsp;虽然执行环节只有两种，但是有一些特殊语句，可以在 `作用域链` 的开头插入一个临时 `变量对象`，当这段语句执行完成后就移除。如下：
    + `try-catch` 语句块的catch块：会创建一个包含抛出错误信息的对象插入 `作用域链` 开头。
    + `with` 语句：会把指定的对象插入 `作用域链` 开头。

### 4. 函数的提升

函数的提升和变量的提升类似，都是提升到作用域的最开始的位置，只不过变量的提升是分两步的，第一步是变量声明的提升，第二步是变量的赋值。而函数的提升是**直接将整个函数整体提升到作用域的最开始位置，相当于剪切过去的样子**。


---

#### [返回目录](./)