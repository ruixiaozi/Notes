## Chrome插件学习笔记 介绍与架构

---

### 1. 介绍

扩展程序由一些文件（包括 HTML、CSS、JavaScript、图片以及其他任何您需要的文件）经过 zip 打包得到，为 Google Chrome 浏览器增加功能。扩展程序本质上是网页，它们可以利用**浏览器为网页提供的所有 API**，例如 XMLHttpRequest、JSON、HTML 5 等等。

扩展程序可以通过**内容脚本**或**跨站 XMLHttpRequest** 与网页或者服务器交互，扩展程序也可以以编程方式与浏览器功能（例如**书签**和**标签页**交互）。

---

### 2. 架构

#### 2.1 文件结构

每一个扩展程序包含以下文件：

- 一个**清单文件**（manifest.json）
- 一个或多个 **HTML 文件**（除非扩展程序是一个主题背景）
- *可选：*一个或多个 **JavaScript 文件**
- *可选：*您的扩展程序需要的任何其他文件，例如图片

当您编写您的扩展程序时，您将所有这些文件放在一个文件夹中。当您发布您的扩展程序时，该文件夹的内容将被压缩成一个特殊的 ZIP 文件，以 `.crx` 为后缀。如果您通过 [Chrome 开发者信息中心](https://chrome.google.com/webstore/developer/dashboard)上传您的扩展程序，该 `.crx` 文件会自动为您创建。

#### 2.2 功能结构

许多扩展程序有一个**后台网页**，它是一个包含扩展程序主要逻辑的不可见页面。扩展程序也可以包含其他页面，展现扩展程序的**用户界面**。如果扩展程序需要与用户加载的网页交互（相对于包含在扩展程序中的页面），扩展程序必须使用**内容脚本**。

1. **后台页面**

   后台网页分两种：持久运行的**后台网页** 与 **事件页面**。正如它们的名称所述，持续运行的后台网页保持打开状态，事件页面根据需要打开与关闭。除非您绝对需要您的后台网页一直运行，请首选事件页面。

2. **用户界面网页**

   扩展程序可以包含普通的 HTML 网页，用来显示扩展程序的用户界面。例如，浏览器按钮可以包含弹出菜单，通过 HTML 文件实现。任何一个扩展程序都可以有选项页面，让用户自定义扩展程序的工作方式。另外一种特殊页面是替代页面。最后，您可以使用`tabs.create`或 `window.open()` 来显示扩展程序中的任何其他 HTML 文件。

   扩展程序中的 HTML 网页可以互相访问其他页面的全部 DOM，并且可以互相调用函数。

   包括**浏览器按钮**、**选项页面**、**替代页面**和**页面间通信**

3. **内容脚本**

   如果您的扩展程序需要与网页交互，您就需要使用**内容脚本**。内容脚本是一些 JavaScript 代码，它们在浏览器中已加载页面的上下文中执行。您应该将内容脚本视为已加载页面的一部分，而不是打包在一起的扩展程序（它*所属的扩展程序*）的一部分。

   内容脚本可以读取浏览器访问的网页的细节，并且可以修改页面。在下图中，内容脚本可以读取并且修改显示的网页的 DOM。然而，它不能修改所属扩展程序后台网页的 DOM。







---

#### [返回目录](./)