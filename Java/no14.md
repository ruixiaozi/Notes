## Java学习笔记 并发
---
### 1. 进程 与 线程

+ 进程：程序的一次执行
+ 线程：轻量级进程，操作系统调度的最小任务单位是线程，共享资源

Java语言内置了多线程支持：一个Java程序实际上是一个JVM进程，JVM进程用一个主线程来执行main()方法，在main()方法内部，我们又可以启动多个线程。

+ 多线程模型是Java程序最基本的并发模型；
+ 后续读写网络、数据库、Web开发等都依赖Java多线程模型

---
### 2. 线程的生命周期（状态）

+ New：新创建的线程，尚未执行；
+ Runnable：运行中的线程，正在执行run()方法的Java代码；
+ Blocked：运行中的线程，因为某些操作被阻塞而挂起；
+ Waiting：运行中的线程，因为某些操作在等待中；
+ Timed Waiting：运行中的线程，因为执行sleep()方法正在计时等待；
+ Terminated：线程已终止，因为run()方法执行完毕。


---
### 3. 创建线程 

1. 继承 `Thread` 类，重写`run()`方法
2. 实现 `Runable` 接口，实现`run()`方法，可用`lambda`表达式代替

线程对象的`join()`方法：

+ 通过对另一个线程对象调用join()方法可以等待其执行结束；
+ 可以指定等待时间，超过等待时间线程仍然没有结束就不再等待；
+ 对已经运行结束的线程调用join()方法会立刻返回。

静态方法`currentThread()`可以获取当前线程对象。

volatile关键字的目的是告诉虚拟机：

+ 每次访问变量时，总是获取主内存的最新值；
+ 每次修改变量后，立刻回写到主内存。

volatile关键字解决的是可见性问题：当一个线程修改了某个共享变量的值，其他线程能够立刻看到修改后的值。

---
### 4. 中断线程 

对目标线程调用interrupt()方法可以请求中断一个线程，目标线程通过检测isInterrupted()标志获取自身是否已中断。如果目标线程处于等待状态，该线程会捕获到InterruptedException；

目标线程检测到isInterrupted()为true或者捕获了InterruptedException都应该立刻结束自身线程；

还可以使用Interrupted静态方法来获取中断状态，但是会清除当前线程的中断状态。

---
### 5. 优先级、礼让、守护线程

+ 优先级：使用`setPriority(int p)`设置一个整型的优先级
+ 礼让：使用`yield()`静态方法，让与当前线程同样优先级的线程先执行
+ 守护线程：只要非守护线程都结束了，守护线程也会自动关闭。使用`setDaemon(boolean isDaemon)`设置一个线程是否为守护线程，要在`start()`之前设置。

---
### 6. 线程同步 

+ 临界资源：两个或两个以上的线程需要共享同一数据的存取
+ 同步的方法：
    1. synchronized 同步代码段：
        ```
        sy
        ```

---
#### [返回目录](./)
